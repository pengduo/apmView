<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9"/>
    <title>jTopo Demo</title>
    <script type="text/javascript" src="js/jtopo-0.4.8-min.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/json2.js"></script>

    <script id='code'>
        var strJson = '';

        $(document).ready(function () {
                    var canvas = document.getElementById('canvas');
                    var stage = new JTopo.Stage(canvas);


                    var scene = new JTopo.Scene(stage);
                    scene.background = './img/bg2.jpg';

                    // 节点
                    function newNode(x, y, w, h, text) {
                        var node = new JTopo.Node(text);
                        node.setLocation(x, y);
                        node.setSize(w, h);
                        scene.add(node);
                        return node;
                    }

                    // 简单连线
                    function newLink(nodeA, nodeZ, text, dashedPattern) {
                        var link = new JTopo.Link(nodeA, nodeZ, text);
                        link.lineWidth = 3; // 线宽
                        link.dashedPattern = dashedPattern; // 虚线
                        link.bundleOffset = 60; // 折线拐角处的长度
                        link.bundleGap = 20; // 线条之间的间隔
                        link.textOffsetY = 3; // 文本偏移量（向下3个像素）
                        link.strokeColor = '0,200,255';
                        scene.add(link);
                        return link;
                    }

                    // 折线
                    function newFoldLink(nodeA, nodeZ, text, direction, dashedPattern) {
                        var link = new JTopo.FoldLink(nodeA, nodeZ, text);
                        link.direction = direction || 'horizontal';
                        link.arrowsRadius = 15; //箭头大小
                        link.lineWidth = 3; // 线宽
                        link.bundleOffset = 60; // 折线拐角处的长度
                        link.bundleGap = 20; // 线条之间的间隔
                        link.textOffsetY = 3; // 文本偏移量（向下3个像素）
                        link.strokeColor = JTopo.util.randomColor(); // 线条颜色随机
                        link.dashedPattern = dashedPattern;
                        scene.add(link);
                        return link;
                    }

                    // 二次折线
                    function newFlexionalLink(nodeA, nodeZ, text, direction, dashedPattern) {
                        var link = new JTopo.FlexionalLink(nodeA, nodeZ, text);
                        link.direction = direction || 'horizontal';
                        link.arrowsRadius = 10;
                        link.lineWidth = 3; // 线宽
                        link.offsetGap = 35;
                        link.bundleGap = 15; // 线条之间的间隔
                        link.textOffsetY = 10; // 文本偏移量（向下15个像素）
                        link.strokeColor = '0,250,0';
                        link.dashedPattern = dashedPattern;
                        scene.add(link);
                        return link;
                    }

                    // 曲线
                    function newCurveLink(nodeA, nodeZ, text) {
                        var link = new JTopo.CurveLink(nodeA, nodeZ, text);
                        link.lineWidth = 3; // 线宽
                        scene.add(link);
                        return link;
                    }

                    var from = newNode(100, 60, 30, 30,"from");
                    var to = newNode(300, 60, 30, 30,"to");
                    var link = newLink(from, to, 'Arrow', 5);
                    link.arrowsRadius = 10;
                    //先将JSON对象转成字符串，然后将其中的“\”符号全部替换成空格
                    strJson = JSON.stringify(stage.toJson()).replace(/\\/g, "");


                    document.getElementById("jsonstr1").innerHTML = strJson;


                    document.getElementById("myBtn").onclick = function () {
                        displayDate()
                    };

                    function displayDate() {
                        strJson = JSON.stringify(stage.toJson()).replace(/\\/g, "");
                        document.getElementById("jsonstr1").innerHTML = strJson;


                    }
                }
        );

    </script>
</head>

<body>

<center>

    <canvas width="850" height="550" id="canvas"></canvas>

    <button id="myBtn">保存配置</button>


</center>

<p id="jsonstr1" style="font-size: small"></p>


</body>

</html>